

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Cluster-biased PCA &mdash; PCA-python  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Train and test data selection" href="train-test-select.html" />
    <link rel="prev" title="Clustering" href="clustering.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> PCA-python
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="PCA.html">Principal Component Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="clustering.html">Clustering</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Cluster-biased PCA</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#biasing-options">Biasing options</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#biasing-option-1">Biasing option 1</a></li>
<li class="toctree-l3"><a class="reference internal" href="#biasing-option-2">Biasing option 2</a></li>
<li class="toctree-l3"><a class="reference internal" href="#biasing-option-3">Biasing option 3</a></li>
<li class="toctree-l3"><a class="reference internal" href="#biasing-option-4">Biasing option 4</a></li>
<li class="toctree-l3"><a class="reference internal" href="#biasing-option-5">Biasing option 5</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#functions">Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#analyze-centers-movement">Analyze centers movement</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#plotting-example">Plotting example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#analyze-eigenvector-weights-movement">Analyze eigenvector weights movement</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">Plotting example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#analyze-eigenvalue-distribution">Analyze eigenvalue distribution</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id2">Plotting example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#equilibrate-cluster-populations">Equilibrate cluster populations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#equilibration">Equilibration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#interpretation-for-the-outputs">Interpretation for the outputs</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="train-test-select.html">Train and test data selection</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/train-test-selection.html">Selecting train and test data</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PCA-python</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Cluster-biased PCA</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/user/cluster-biased-pca.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <span class="target" id="module-PCA.cluster_biased_pca"></span><div class="section" id="cluster-biased-pca">
<h1>Cluster-biased PCA<a class="headerlink" href="#cluster-biased-pca" title="Permalink to this headline">¶</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">cluster_biased_pca.py</span></code> module contains functions for performing analysis of data sets using cluster-biased PCA. Cluster-biased PCA is a link between local PCA and global PCA - it is using local features to inform (bias) the global PCs.</p>
<p>The general methodology for cluster-biased PCA is presented in the scheme below:</p>
<a class="reference internal image-reference" href="../_images/cluster-biased-PCA-scheme-sampling-highlighted.png"><img alt="../_images/cluster-biased-PCA-scheme-sampling-highlighted.png" src="../_images/cluster-biased-PCA-scheme-sampling-highlighted.png" style="width: 700px;" /></a>
<div class="section" id="biasing-options">
<h2>Biasing options<a class="headerlink" href="#biasing-options" title="Permalink to this headline">¶</a></h2>
<p>This section explains the choice for <code class="docutils literal notranslate"><span class="pre">biasing_option</span></code> input parameter in some of the functions in this module.</p>
<p>Schemes below present how centering and scaling of data sets can be handled and how PCA transformations are done using the original eigenvectors <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> vs. the biased eigenvectors <span class="math notranslate nohighlight">\(\mathbf{A_r}\)</span>. The superscript <span class="math notranslate nohighlight">\((i)\)</span> represents the <span class="math notranslate nohighlight">\(i^{th}\)</span> version of the idx vector.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Given the same <code class="docutils literal notranslate"><span class="pre">idx</span></code>, the eigenvectors matrix <span class="math notranslate nohighlight">\(\mathbf{A_r}\)</span> will be the same in option 1, 3 and 4 (the reduced data set is pre-processed in the same way in these three options). It will only be different in option 2 where the reduced data set is not pre-processed after being sampled from <span class="math notranslate nohighlight">\(\mathbf{X_{cs}}\)</span>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The biased PC-scores <span class="math notranslate nohighlight">\(\mathbf{Z_{biased}}\)</span> resulting from option 4 are included within the biased PC-scores <span class="math notranslate nohighlight">\(\mathbf{Z_{biased}}\)</span> resulting from option 3. Note that the only difference going with option 3 instead of option 4 is that there will be more observations in the PC-scores matrix, but the data set that is transformed by PCA in both cases was pre-processed using the same centers and scales.</p>
</div>
<div class="section" id="biasing-option-1">
<h3>Biasing option 1<a class="headerlink" href="#biasing-option-1" title="Permalink to this headline">¶</a></h3>
<p>In this option, the projection is always done using the centered and scaled original data set <span class="math notranslate nohighlight">\(\mathbf{X_{cs}}\)</span> (centered with <span class="math notranslate nohighlight">\(\mathbf{C}\)</span> and scaled with <span class="math notranslate nohighlight">\(\mathbf{D}\)</span>). When sources of the PCs are computed, they are scaled by the scaling coming from the original data matrix <span class="math notranslate nohighlight">\(\mathbf{X}\)</span>. The centers and scales of the reduced data set (<span class="math notranslate nohighlight">\(\mathbf{C_r}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{D_r}\)</span>) are not used anywhere beyond the pre-processing step.</p>
<a class="reference internal image-reference" href="../_images/cb-PCA-scheme-option-1.png"><img alt="../_images/cb-PCA-scheme-option-1.png" class="align-center" src="../_images/cb-PCA-scheme-option-1.png" style="width: 700px;" /></a>
</div>
<div class="section" id="biasing-option-2">
<h3>Biasing option 2<a class="headerlink" href="#biasing-option-2" title="Permalink to this headline">¶</a></h3>
<p>This option is the same as option 1, except we sample directly from <span class="math notranslate nohighlight">\(\mathbf{X_{cs}}\)</span> and then without additionally pre-processing <span class="math notranslate nohighlight">\(\mathbf{X_r}\)</span>, we perform PCA on a reduced data set.</p>
<a class="reference internal image-reference" href="../_images/cb-PCA-scheme-option-2.png"><img alt="../_images/cb-PCA-scheme-option-2.png" class="align-center" src="../_images/cb-PCA-scheme-option-2.png" style="width: 700px;" /></a>
</div>
<div class="section" id="biasing-option-3">
<h3>Biasing option 3<a class="headerlink" href="#biasing-option-3" title="Permalink to this headline">¶</a></h3>
<p>In this option, the projection is always done using the original data set <span class="math notranslate nohighlight">\(\mathbf{X}\)</span> centered and scaled with the centers and scales found on the reduced data set <span class="math notranslate nohighlight">\(\mathbf{X_r}\)</span> (centered by <span class="math notranslate nohighlight">\(\mathbf{C_r}\)</span> and scaled by <span class="math notranslate nohighlight">\(\mathbf{D_r}\)</span>). The sources <span class="math notranslate nohighlight">\(\mathbf{S}\)</span> are scaled with <span class="math notranslate nohighlight">\(\mathbf{D_r}\)</span> as well to match the data set scaling.</p>
<a class="reference internal image-reference" href="../_images/cb-PCA-scheme-option-3.png"><img alt="../_images/cb-PCA-scheme-option-3.png" class="align-center" src="../_images/cb-PCA-scheme-option-3.png" style="width: 700px;" /></a>
</div>
<div class="section" id="biasing-option-4">
<h3>Biasing option 4<a class="headerlink" href="#biasing-option-4" title="Permalink to this headline">¶</a></h3>
<p>In this option, the projection is done on the reduced data set <span class="math notranslate nohighlight">\(\mathbf{X_r}\)</span> centered with <span class="math notranslate nohighlight">\(\mathbf{C_r}\)</span> and scaled with <span class="math notranslate nohighlight">\(\mathbf{D_r}\)</span>.
Source terms <span class="math notranslate nohighlight">\(\mathbf{S}\)</span> have to be sampled as well, using the same <code class="docutils literal notranslate"><span class="pre">idx</span></code> vector. The sampled sources <span class="math notranslate nohighlight">\(\mathbf{S}\)</span> are scaled with <span class="math notranslate nohighlight">\(\mathbf{D_r}\)</span> as well to match the data set scaling.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The major difference from the other three options is that this time, the number of transported observations is different from the original number of observations in the original data set.</p>
</div>
<a class="reference internal image-reference" href="../_images/cb-PCA-scheme-option-4.png"><img alt="../_images/cb-PCA-scheme-option-4.png" class="align-center" src="../_images/cb-PCA-scheme-option-4.png" style="width: 700px;" /></a>
</div>
<div class="section" id="biasing-option-5">
<h3>Biasing option 5<a class="headerlink" href="#biasing-option-5" title="Permalink to this headline">¶</a></h3>
<p>In this option, the reduced data set is only found in order to compute its centers and scales. Once we have that, we go back to the original data set and pre-process it using <span class="math notranslate nohighlight">\(\mathbf{C_r}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{D_r}\)</span>. PCA transformation is done on the entire data set <span class="math notranslate nohighlight">\(\mathbf{X_{cs}^{(i)}}\)</span> and the same data set is projected onto the found eigenvectors.</p>
<a class="reference internal image-reference" href="../_images/cb-PCA-scheme-option-5.png"><img alt="../_images/cb-PCA-scheme-option-5.png" class="align-center" src="../_images/cb-PCA-scheme-option-5.png" style="width: 700px;" /></a>
</div>
</div>
<div class="section" id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="analyze-centers-movement">
<h3>Analyze centers movement<a class="headerlink" href="#analyze-centers-movement" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="PCA.cluster_biased_pca.analyze_centers_movement">
<code class="sig-prename descclassname">PCA.cluster_biased_pca.</code><code class="sig-name descname">analyze_centers_movement</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">idx_X_r</span></em>, <em class="sig-param"><span class="n">variable_names</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">plot_variables</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">save_plot</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">save_filename</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="headerlink" href="#PCA.cluster_biased_pca.analyze_centers_movement" title="Permalink to this definition">¶</a></dt>
<dd><p>This function analyzes the movement of centers in the subset of the original
data set <code class="docutils literal notranslate"><span class="pre">X_r</span></code> with respect to the full original data set <code class="docutils literal notranslate"><span class="pre">X</span></code>.</p>
<p><strong>Note:</strong></p>
<p>The original data set <code class="docutils literal notranslate"><span class="pre">X</span></code> is first normalized so that each variable ranges
from 0 to 1. Samples are then extracted from the normalized data set to form
<code class="docutils literal notranslate"><span class="pre">X_r</span></code>. The normalization is done so that centers can be compared across
variables on one plot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – original (full) data set.</p></li>
<li><p><strong>idx_X_r</strong> – vector of indices that should be extracted from <code class="docutils literal notranslate"><span class="pre">X</span></code> to form <code class="docutils literal notranslate"><span class="pre">X_r</span></code>.
It could be obtained as training indices from
<code class="docutils literal notranslate"><span class="pre">training_data_generation</span></code> module.</p></li>
<li><p><strong>variable_names</strong> – (optional)
list of strings specifying variable names.</p></li>
<li><p><strong>plot_variables</strong> – (optional)
list of integers specifying indices of variables to be plotted.
By default, all variables are plotted.</p></li>
<li><p><strong>title</strong> – (optional)
boolean or string specifying plot title. If set to <code class="docutils literal notranslate"><span class="pre">False</span></code>,
title will not be plotted.</p></li>
<li><p><strong>save_plot</strong> – (optional)
boolean specifying whether the plot should be saved.</p></li>
<li><p><strong>save_filename</strong> – (optional)
plot save location/filename.</p></li>
</ul>
</dd>
</dl>
<p><strong>Returns:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">norm_centers_X</span></code> - normalized centers of the original (full) data set <code class="docutils literal notranslate"><span class="pre">X</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">norm_centers_X_r</span></code> - normalized centers of the reduced data set <code class="docutils literal notranslate"><span class="pre">X_r</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">center_movement_percentage</span></code> - relative percentage specifying how the center has moved between <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">X_r</span></code>. The movement is measured relative to the original (full) data set <code class="docutils literal notranslate"><span class="pre">X</span></code>.</p></li>
</ul>
</dd></dl>

<div class="section" id="plotting-example">
<h4>Plotting example<a class="headerlink" href="#plotting-example" title="Permalink to this headline">¶</a></h4>
<p>This function will produce a plot that shows the normalized centers and a percentage by which the new centers have moved with respect to the original ones. Example of a plot:</p>
<a class="reference internal image-reference" href="../_images/relative_centers_movement.png"><img alt="../_images/relative_centers_movement.png" class="align-center" src="../_images/relative_centers_movement.png" style="width: 500px;" /></a>
<p>If you do not wish to plot all variables present in a data set, use the <code class="docutils literal notranslate"><span class="pre">plot_variables</span></code> list as an input parameter to select indices of variables to plot:</p>
<a class="reference internal image-reference" href="../_images/relative_centers_movement_selected_variables.png"><img alt="../_images/relative_centers_movement_selected_variables.png" class="align-center" src="../_images/relative_centers_movement_selected_variables.png" style="width: 260px;" /></a>
</div>
</div>
<div class="section" id="analyze-eigenvector-weights-movement">
<h3>Analyze eigenvector weights movement<a class="headerlink" href="#analyze-eigenvector-weights-movement" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="PCA.cluster_biased_pca.analyze_eigenvector_weights_movement">
<code class="sig-prename descclassname">PCA.cluster_biased_pca.</code><code class="sig-name descname">analyze_eigenvector_weights_movement</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eigenvector_matrix</span></em>, <em class="sig-param"><span class="n">variable_names</span></em>, <em class="sig-param"><span class="n">plot_variables</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">normalize</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">zero_norm</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">save_plot</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">save_filename</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="headerlink" href="#PCA.cluster_biased_pca.analyze_eigenvector_weights_movement" title="Permalink to this definition">¶</a></dt>
<dd><p>This function analyzes the movement of weights on an eigenvector obtained
from a reduced data set at each iteration. The color-coding marks the
iteration number - if there is a consistent trend the coloring should form
a clear trajectory. The zero-th iteration corresponds to eigenvectors found
on the original data set X. The last iteration corresponds to eigenvectors
found on the “equilibrated” data set.</p>
<p><strong>Note:</strong></p>
<p>This function plots absolute, (and optionally normalized) values of weights on each
variable. Columns are normalized dividing by the maximum value. This is
done in order to compare the movement of weights equally, with the highest,
normalized one being equal to 1. You can additionally set the
<code class="docutils literal notranslate"><span class="pre">zero_norm=True</span></code> in order to normalize weights such that they are between
0 and 1 (this is not done by default).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eigenvector_matrix</strong> – matrix of concatenated eigenvectors coming from different data sets or
from different iterations.</p></li>
<li><p><strong>variable_names</strong> – list of strings specifying variable names.</p></li>
<li><p><strong>plot_variables</strong> – (optional)
list of integers specifying indices of variables to be plotted.
By default, all variables are plotted.</p></li>
<li><p><strong>normalize</strong> – (optional)
boolean specifying whether weights should be normlized at all.
If set to false, the absolute values are plotted.</p></li>
<li><p><strong>zero_norm</strong> – (optional)
boolean specifying whether weights should be normalized between 0 and 1.
By default they are not normalized to start at 0.
Only has effect if <code class="docutils literal notranslate"><span class="pre">normalize=True</span></code>.</p></li>
<li><p><strong>title</strong> – (optional)
boolean or string specifying plot title. If set to <code class="docutils literal notranslate"><span class="pre">False</span></code>, title will
not be plotted.</p></li>
<li><p><strong>save_plot</strong> – (optional)
boolean specifying whether the plot should be saved.</p></li>
<li><p><strong>save_filename</strong> – (optional)
plot save location/filename.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – if the number of variables in <code class="docutils literal notranslate"><span class="pre">variable_names</span></code> list does not
correspond to variables in the <code class="docutils literal notranslate"><span class="pre">eigenvectors_matrix</span></code>.</p>
</dd>
</dl>
</dd></dl>

<div class="section" id="id1">
<h4>Plotting example<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<p>Three weight normalization variants are available:</p>
<ul class="simple">
<li><p>No normalization, the absolute values of the eigenvector weights are plotted. To use this variant set <code class="docutils literal notranslate"><span class="pre">normalize=False</span></code>. Example can be seen below:</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/documentation-plot-non-normalized.png"><img alt="../_images/documentation-plot-non-normalized.png" class="align-center" src="../_images/documentation-plot-non-normalized.png" style="width: 500px;" /></a>
<ul class="simple">
<li><p>Normalizing so that the highest weight is equal to 1 and the smallest weight is between 0 and 1. This is useful for judging the severity of the weight movement. To use this variant set <code class="docutils literal notranslate"><span class="pre">normalize=True</span></code> and <code class="docutils literal notranslate"><span class="pre">zero_norm=False</span></code>. Example can be seen below:</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/documentation-plot-normalized.png"><img alt="../_images/documentation-plot-normalized.png" class="align-center" src="../_images/documentation-plot-normalized.png" style="width: 500px;" /></a>
<ul class="simple">
<li><p>Normalizing so that weights are between 0 and 1. This is useful for judging the movement trends since it will blow up even the smallest changes to the entire range 0-1. To use this variant set <code class="docutils literal notranslate"><span class="pre">normalize=True</span></code> and <code class="docutils literal notranslate"><span class="pre">zero_norm=True</span></code>. Example can be seen below:</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/documentation-plot-normalized-to-zero.png"><img alt="../_images/documentation-plot-normalized-to-zero.png" class="align-center" src="../_images/documentation-plot-normalized-to-zero.png" style="width: 500px;" /></a>
<p>If you do not wish to plot all variables present in a data set, use the <code class="docutils literal notranslate"><span class="pre">plot_variables</span></code> list as an input parameter to select indices of variables to plot:</p>
<a class="reference internal image-reference" href="../_images/pre_selected_vars.png"><img alt="../_images/pre_selected_vars.png" class="align-center" src="../_images/pre_selected_vars.png" style="width: 280px;" /></a>
</div>
</div>
<div class="section" id="analyze-eigenvalue-distribution">
<h3>Analyze eigenvalue distribution<a class="headerlink" href="#analyze-eigenvalue-distribution" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="PCA.cluster_biased_pca.analyze_eigenvalue_distribution">
<code class="sig-prename descclassname">PCA.cluster_biased_pca.</code><code class="sig-name descname">analyze_eigenvalue_distribution</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">idx_matrix</span></em>, <em class="sig-param"><span class="n">k_list</span></em>, <em class="sig-param"><span class="n">scaling</span></em>, <em class="sig-param"><span class="n">biasing_option</span></em>, <em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">save_plot</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">save_filename</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="headerlink" href="#PCA.cluster_biased_pca.analyze_eigenvalue_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>This function analyzes the normalized eigenvalue distribution when PCA is
performed on different versions of the reduced data sets <code class="docutils literal notranslate"><span class="pre">X_r</span></code> vs. on the
original data set <code class="docutils literal notranslate"><span class="pre">X</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – original (full) data set.</p></li>
<li><p><strong>idx_matrix</strong> – matrix of collected idx vectors.</p></li>
<li><p><strong>k_list</strong> – list of numerical labels for the idx_matrix columns.</p></li>
<li><p><strong>scaling</strong> – data scaling criterion.</p></li>
<li><p><strong>biasing_option</strong> – integer specifying biasing option.
See documentation of cluster-biased PCA for more information.
Can only attain values [1,2,3,4,5].</p></li>
<li><p><strong>title</strong> – (optional)
boolean or string specifying plot title. If set to <code class="docutils literal notranslate"><span class="pre">False</span></code>,
title will not be plotted.</p></li>
<li><p><strong>save_plot</strong> – (optional)
boolean specifying whether the plot should be saved.</p></li>
<li><p><strong>save_filename</strong> – (optional)
plot save location/filename.</p></li>
</ul>
</dd>
</dl>
<p><strong>Returns:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">min_at_q2_k</span></code> - label for which the eigenvalue was smallest when q=2.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">min_at_q3_k</span></code> - label for which the eigenvalue was smallest when q=3.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_at_q2_k</span></code> - label for which the eigenvalue was largest when q=2.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_at_q3_k</span></code> - label for which the eigenvalue was largest when q=3.</p></li>
</ul>
</dd></dl>

<div class="section" id="id2">
<h4>Plotting example<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<p>This function will produce a plot that shows the eigenvalues distribution for the original data set and for different versions of the equilibrated data set. Example of a plot:</p>
<a class="reference internal image-reference" href="../_images/documentation-eigenvalues.png"><img alt="../_images/documentation-eigenvalues.png" class="align-center" src="../_images/documentation-eigenvalues.png" style="width: 500px;" /></a>
</div>
</div>
<div class="section" id="equilibrate-cluster-populations">
<h3>Equilibrate cluster populations<a class="headerlink" href="#equilibrate-cluster-populations" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="PCA.cluster_biased_pca.equilibrate_cluster_populations">
<code class="sig-prename descclassname">PCA.cluster_biased_pca.</code><code class="sig-name descname">equilibrate_cluster_populations</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">idx</span></em>, <em class="sig-param"><span class="n">scaling</span></em>, <em class="sig-param"><span class="n">X_source</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">biasing_option</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">n_iterations</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">stop_iter</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#PCA.cluster_biased_pca.equilibrate_cluster_populations" title="Permalink to this definition">¶</a></dt>
<dd><p>This function gradually equilibrates cluster populations heading towards
population of the smallest cluster in <code class="docutils literal notranslate"><span class="pre">n_iterations</span></code>.</p>
<p>At each iteration it generates the reduced data set <code class="docutils literal notranslate"><span class="pre">X_r(i)</span></code> made up from
new populations, performs PCA on that data set to find the <code class="docutils literal notranslate"><span class="pre">i-th</span></code> version of
the eigenvectors. Depending on the option selected, it then does the
projection of a data set (and optionally also its sources) onto the found
eigenvectors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – original (full) data set.</p></li>
<li><p><strong>idx</strong> – vector of indices classifying observations to clusters.
The first cluster has index 0.</p></li>
<li><p><strong>scaling</strong> – data scaling criterion.</p></li>
<li><p><strong>X_source</strong> – source terms corresponding to the state-space variables in <code class="docutils literal notranslate"><span class="pre">X</span></code>.</p></li>
<li><p><strong>biasing_option</strong> – integer specifying biasing option.
See documentation of cluster-biased PCA for more information.
Can only attain values [1,2,3,4,5].</p></li>
<li><p><strong>n_iterations</strong> – number of iterations to loop over.</p></li>
<li><p><strong>stop_iter</strong> – number of iteration to stop.</p></li>
<li><p><strong>verbose</strong> – boolean for printing verbose details.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – if <code class="docutils literal notranslate"><span class="pre">biasing_option</span></code> is not 1, 2, 3, 4 or 5.</p>
</dd>
</dl>
<p><strong>Returns:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">eigenvalues</span></code> - collected eigenvalues from each iteration.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">eigenvectors</span></code> - collected eigenvectors from each iteration.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pc_scores</span></code> - collected PC scores from each iteration.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pc_sources</span></code> - collected PC-1 sources from each iteration. This variable is only returned if <code class="docutils literal notranslate"><span class="pre">X_sources</span></code> was passed as an input parameter.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">idx_train</span></code> - the final training indices from the equilibrated iteration.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">X_center</span></code> - a vector of final centers that were used to center the data set at the last (equlibration) iteration.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">X_scale</span></code> - a vector of final scales that were used to scale the data set at the last (equlibration) iteration.</p></li>
</ul>
</dd></dl>

<div class="section" id="equilibration">
<h4>Equilibration<a class="headerlink" href="#equilibration" title="Permalink to this headline">¶</a></h4>
<p>For the moment, there is only one way implemented for the equilibration. The smallest cluster is found and any larger <code class="docutils literal notranslate"><span class="pre">j-th</span></code> cluster’s observations are diminished at each iteration by</p>
<div class="math notranslate nohighlight">
\[\frac{\verb|N_j| - \verb|N_smallest_cluster|}{\verb|n_iterations|}\]</div>
<p><code class="docutils literal notranslate"><span class="pre">N_j</span></code> is the number of observations in the <code class="docutils literal notranslate"><span class="pre">j-th</span></code> cluster and <code class="docutils literal notranslate"><span class="pre">N_smallest_cluster</span></code> is the number of observations in the smallest cluster. <code class="docutils literal notranslate"><span class="pre">n_iterations</span></code> is an input parameter in the function.
This is presented in the scheme below:</p>
<a class="reference internal image-reference" href="../_images/cluster-equilibration-scheme.png"><img alt="../_images/cluster-equilibration-scheme.png" class="align-center" src="../_images/cluster-equilibration-scheme.png" style="width: 700px;" /></a>
<p>Future implementation might include equilibration that slows down close to equilibrium. This might be helpful for sensitivity analysis.</p>
</div>
<div class="section" id="interpretation-for-the-outputs">
<h4>Interpretation for the outputs<a class="headerlink" href="#interpretation-for-the-outputs" title="Permalink to this headline">¶</a></h4>
<p>This function returns 3D arrays <code class="docutils literal notranslate"><span class="pre">eigenvectors</span></code>, <code class="docutils literal notranslate"><span class="pre">pc_scores</span></code> and <code class="docutils literal notranslate"><span class="pre">pc_sources</span></code> that have the following structure:</p>
<a class="reference internal image-reference" href="../_images/cbpca-equlibrate-outputs.png"><img alt="../_images/cbpca-equlibrate-outputs.png" class="align-center" src="../_images/cbpca-equlibrate-outputs.png" style="width: 700px;" /></a>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="train-test-select.html" class="btn btn-neutral float-right" title="Train and test data selection" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="clustering.html" class="btn btn-neutral float-left" title="Clustering" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Elizabeth Armstrong, Kamila Zdybal

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>